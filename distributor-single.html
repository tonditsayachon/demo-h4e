<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>รายละเอียดผู้จัดจำหน่าย</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="icon" href="assets/images/h4e-logo.png" type="image/png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>

<body>
    <header class="top-bar">
        <div class="container top-bar-container">
            <a href="index.html" class="logo"><img src="assets/images/h4e-logo.png" alt="H4E Logo"></a>
            <nav class="top-nav">
                <a href="index.html" class="nav-link lang-text" data-key="nav_home">E-Number</a>
                <a href="distributors.html" class="nav-link lang-text" data-key="nav_distributors">Distributors</a>
                <a href="login.html" class="nav-link login-btn lang-text" data-key="nav_login">Login</a>
                <button id="lang-switcher-btn" class="icon-btn" title="เปลี่ยนภาษา"><img src="assets/images/th-flag.svg"
                        alt="Thai Language"></button>
            </nav>
        </div>
    </header>

    <div class="container single-content">
        <nav class="breadcrumbs">
            <a href="index.html">หน้าหลัก</a>
            <span>/</span>
            <a href="distributors.html">ผู้จัดจำหน่าย</a>
            <span>/</span>
            <strong id="breadcrumb-current-page">...</strong>
        </nav>

        <div class="distributor-profile-header">
            <img id="distributor-logo" src="https://via.placeholder.com/150" alt="Company Logo">
            <div class="distributor-profile-info">
                <h1 id="distributor-name">กำลังโหลด...</h1>
                <p id="distributor-description"></p>
            </div>
        </div>

        <div class="detail-grid">
            <div class="detail-card">
                <h3><i class="fas fa-map-marker-alt"></i> ข้อมูลที่อยู่</h3>
                <table class="contact-table">
                    <tbody>
                        <tr>
                            <td><strong>ที่อยู่:</strong></td>
                            <td id="distributor-address">-</td>
                        </tr>
                        <tr id="province-row">
                            <td><strong>จังหวัด:</strong></td>
                            <td id="distributor-province">-</td>
                        </tr>
                        <tr>
                            <td><strong>ประเทศ:</strong></td>
                            <td id="distributor-country">-</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="detail-card">
                <h3><i class="fas fa-phone-alt"></i> ข้อมูลติดต่อ</h3>
                <table class="contact-table">
                    <tbody>
                        <tr>
                            <td><strong>โทรศัพท์:</strong></td>
                            <td id="distributor-phone">-</td>
                        </tr>
                        <tr>
                            <td><strong>อีเมล:</strong></td>
                            <td id="distributor-email">-</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="detail-card">
            <h3>สาร E-Number ที่จัดจำหน่าย (<span id="e-number-count">0</span>)</h3>
            <ul id="e-number-list" class="e-number-list">
            </ul>
        </div>
    </div>

    <footer class="site-footer">
        <div class="container footer-container">
            <div class="footer-about">

                <h4>Connect With Us</h4>
                <h5>ศูนย์วิทยาศาสตร์ฮาลาล จุฬาลงกรณ์มหาวิทยาลัย</h5>
                <p>254 อาคารวิจัยจุฬาลงกรณ์มหาวิทยาลัย ชั้น 11-13 ถนนพญาไท แขวงวังใหม่ เขตปทุมวัน กรุงเทพฯ 10330
                </p>
                <h5>อีเมล</h5>
                <p>info.hsc.cu@gmail.com</p>
                <h5>โทรศัพท์</h5>
                <p>02-218-1054</p>

            </div>
            <div class="footer-contact">
                <iframe
                    src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3875.5983950843292!2d100.52421707509005!3d13.742747386648173!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x30e29ed4f6e235b3%3A0xe23aff93db3c0ccf!2z4Lio4Li54LiZ4Lii4LmM4Lin4Li04LiX4Lii4Liy4Lio4Liy4Liq4LiV4Lij4LmM4Liu4Liy4Lil4Liy4LilIOC4iOC4uOC4rOC4suC4peC4h-C4geC4o-C4k-C5jOC4oeC4q-C4suC4p-C4tOC4l-C4ouC4suC4peC4seC4oiAoVGhlIEhhbGFsIFNjaWVuY2UgQ2VudGVyLCBDVSk!5e0!3m2!1sen!2sth!4v1754020291256!5m2!1sen!2sth"
                    width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy"
                    referrerpolicy="no-referrer-when-downgrade"></iframe>
            </div>
        </div>


        </div>
        <div class="footer-bottom">
            <p class="lang-text" data-key="footer_copyright">Copyrights ©2022 The Halal Science Center. All Right
                Reserved.</p>
        </div>
    </footer>


</body>

</html>

<script src="js/mock-data.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const distributorId = parseInt(window.location.hash.substring(1));
        if (!distributorId) { /* Handle error */ return; }
        const distributor = distributorsData.find(d => d.distributor_id === distributorId);
        if (!distributor) { /* Handle error */ return; }

        // --- Populate Distributor Details ---
        document.title = distributor.company_name_th;
        document.getElementById('breadcrumb-current-page').textContent = distributor.company_name_th;
        document.getElementById('distributor-logo').src = distributor.logo;
        document.getElementById('distributor-name').textContent = distributor.company_name_th;
        document.getElementById('distributor-description').textContent = distributor.description_th;
        document.getElementById('distributor-address').textContent = distributor.address_th || '-';
        document.getElementById('distributor-country').textContent = distributor.country_th;
        const provinceRow = document.getElementById('province-row');
        if (distributor.country_th === 'ไทย') {

            document.getElementById('distributor-province').textContent = distributor.province_th;
        } else {
            provinceRow.style.display = 'none';
        }
        document.getElementById('distributor-phone').textContent = distributor.phone || '-';
        document.getElementById('distributor-email').textContent = distributor.email || '-';

        // --- Populate E-Number List ---
        const usedENumbers = eNumbersData.filter(e => e.distributor_ids.includes(distributorId));
        const eNumberListEl = document.getElementById('e-number-list');
        document.getElementById('e-number-count').textContent = usedENumbers.length;

        if (usedENumbers.length > 0) {
            const getStatusInfo = (statusKey) => {
                switch (statusKey) {
                    case 'halal-cert': return { text: 'ฮาลาล (รับรอง)', className: 'status-orange' };
                    case 'halal-fatwa': return { text: 'ฮาลาล (ฟัตวา)', className: 'status-green' };
                    case 'mashbooh': return { text: 'มัชบูฮ์', className: 'status-red' };
                    case 'haram': return { text: 'ฮารอม', className: 'status-red' };
                    case 'unidentified': return { text: 'ไม่ระบุ', className: 'status-grey' };
                    default: return { text: 'ไม่ระบุ', className: 'status-grey' };
                }
            };
            usedENumbers.forEach(eNumber => {
                const statusInfo = getStatusInfo(eNumber.status);
                const li = document.createElement('li');
                li.className = 'e-number-item';
                const certificationText = eNumber && eNumber.certification_body_th ? ` - ${eNumber.certification_body_th}` : '';

                li.innerHTML = `
                        <a href="e-number-single.html#${eNumber.e_code}">
                            <span class="e-number-item-info">${eNumber.e_code} - ${eNumber.name_th}</span>
                           
                             <span class="status ${statusInfo.className}">${statusInfo.text}${certificationText}</span>
                        </a>
                    `;
                eNumberListEl.appendChild(li);
            });
        } else {
            eNumberListEl.innerHTML = '<li>ไม่พบข้อมูลการใช้งานสารในรายการของผู้จัดจำหน่ายนี้</li>';
        }
    });
</script>
</body>

</html>